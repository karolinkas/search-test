<html>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
    <link type="text/css" rel="stylesheet" href="styles.css" />
    <script>
    $(function () {
    	var minlength = 3;

    	$("#tabletitle").hide();
    	$("#numberbox").hide();

	    $("#string").keyup(function() {
	        var that = this,
	            string = $(this).val();
	        if (string.length >= minlength ) {
		        $.ajax({
		                url: "https://api.github.com/search/repositories?q=" + string + "&sort=stars&order=desc",
		                type: "get",
		                dataType: "jsonp"
		            })
		            .done(function(data, status) {
		            	if (string==$(that).val()) {
		                var searchresults = JSON.stringify(data.data.items.length);
		                var items = data.data.items;
		                
		                $("#tabletitle").show();
		                $("#numberbox").show();
		                $('.results').remove();
		                $('#results').html(JSON.stringify(data));
		                $('#number').html(searchresults);

		                $.each(items, function(index, value) {
		                    $("#items").append('<tr class="results">'
		                    										+'<td>' + value.name + '</td>'
		                    										+'</tr>');
		                });

		                $.each(items, function(index, value) {
		                    var date = value.created_at.substring(0, 10);;
		                    $("#details").append('<tr class="results">'
		                    										+'<td>' + date + '</td>'
		                    										+'</tr>');
		                });
		              }

		            })
		            .fail(function(gbstatus) {
		                alert('Fail: ' + JSON.stringify(status));
		            })
					}
		  });

		});
    </script>
</head>

<body>

    <div class="container">

        <h1>Github Search</h1>
        <input id="string" type="text" />
        <button id="search" onkeyup="keyup()">Search</button>

        <div id="numberbox"> Number of search results:
            <p id="number"></p>
        </div>

        <table>
					<thead id="tabletitle">
						<th id="repo"> Repositories:
		        </th>
		        <th id="creation"> Date of creation:
		        </th>
					</thead>

            <tr>
                <td id="items">
                </td>
                <td id="details">
                </td>
            </tr>

        </table>

    </div>

</body>

</html>
